# 台北 BYOB 餐廳資料庫專案說明（2025-08-01 更新）

本專案致力於打造一個讓民眾能快速查詢「台北市可自帶酒水（BYOB）」餐廳的資訊平台，並協助餐廳主動登錄資料。專案採用 WordPress 作為後台資料管理與資料庫平台，並預計開發 React App 作為前端介面，供行動裝置使用者快速查詢與篩選使用。

---

## 📌 最新進度概要（2025-08-01）

### ✅ PHP 檔案 emoji 亂碼問題修正完成

* 成功修正 `archive-restaurant.php` 和 `single_restaurant.php` 中的 emoji 顯示問題
* 將所有 emoji 圖示替換為 HTML 實體編碼：
  - 地址圖示：`&#128205;` 📍
  - 電話圖示：`&#128222;` 📞
  - 開瓶費圖示：`&#127864;` 🥂
  - 開瓶費說明圖示：`&#127881;` 🪙
  - 備註圖示：`&#128221;` 📝
* 確保在不同環境下都能正確顯示圖示

### ✅ 開酒服務欄位邏輯修改完成

* 修改兩個 PHP 檔案支援開酒服務的「其他」選項
* 新增條件式文字欄位 `open_bottle_service_other_note` 處理邏輯
* 顯示格式：
  - 選擇「是」：顯示「是」
  - 選擇「否」：顯示「否」
  - 選擇「其他」：顯示「其他：說明文字」
* 使用 `esc_html()` 確保安全性

### ✅ 開瓶費說明欄位邏輯修改完成

* 修改兩個 PHP 檔案支援開瓶費說明的條件式顯示
* 新增 `corkage_fee_other` 欄位處理邏輯
* 顯示邏輯：
  - 選擇「酌收」且有金額：顯示金額
  - 選擇「其他」且有說明：顯示說明文字
  - 其他情況：顯示原始選項值
* 保持原有的圖示 `&#129380;` 不變

### ✅ Apps Script 電話號碼處理邏輯修正完成

* 修正數字類型電話號碼前導 0 消失的問題
* 新增處理邏輯：
  - 8位數：補回 `02` 前綴（市話格式）
  - 9位數：補回 `0` 前綴（可能是被截斷的手機號碼）
  - 10位數：補回 `0` 前綴（完整手機號碼）
* 確保所有電話號碼格式正確保留前導 0

### ✅ Logo 設計概念生成與選擇完成

* 生成三個 logo 設計概念：
  - 概念一：「高腳杯與地圖」融合設計
  - 概念二：「酒杯與指南針」組合
  - 概念三：「酒瓶標籤式地圖」
* 修正概念一：將酒瓶改為高腳杯，更符合餐廳氛圍
* 提供 Midjourney prompt 並調整為適合 logo 的平面設計風格
* 生成多張 logo 設計圖，選擇第二張（深酒紅色高腳杯 + 白色地圖網格）作為最終方案

### ✅ 技術問題解決完成

* 修正 PHP 檔案中的 JavaScript 程式碼錯誤
* 統一複選欄位處理邏輯
* 確保資料格式一致性
* 建立安全性處理機制

---

## 🗂️ 已完成項目

* 熱門區域桌機與手機版完成
* 熱門餐廳類型手機版完成
* 精選餐廳桌機版 Grid 確立，手機版 Slider 完成
* 桌機版 hover 效果設定完成
* Slider 導覽樣式優化完成
* 設計規劃工作完成
* 技術問題解決完成
* 餐廳類型複選功能完成
* Apps Script 開瓶費邏輯修正完成
* PHP 檔案複選處理邏輯建立完成
* Google 表單匯入方案規劃完成
* PHP 檔案 emoji 亂碼問題修正完成
* 開酒服務欄位邏輯修改完成
* 開瓶費說明欄位邏輯修改完成
* Apps Script 電話號碼處理邏輯修正完成
* Logo 設計概念生成與選擇完成

---

## 🗓 明日預定任務

1. 完成 Logo 設計的圖片處理和格式轉換
2. 進行網站頁面的最後微調和測試
3. 實作 Google 表單自動導入 WordPress 功能
4. 建立完整的資料流程文件
5. 確保所有功能正確運作

---

## 🎨 設計規範

### 色彩系統
* **主要色彩**：深酒紅色 `#8b2635`
* **輔助色彩**：深灰黑色 `#1a1a1a`
* **背景色彩**：白色 `#ffffff`

### 圖片規範
* **比例**：4:3（餐廳類型圖片）、16:9（橫幅圖片）
* **風格**：深酒紅色調、專業攝影風格、符合 BYOB 氛圍
* **命名**：`restaurant_type_[類型]_[編號].png`

### 技術規範
* **Slider 設定**：80% Slide Width + Center Align
* **Hover 效果**：Zoom + Remove Overlay
* **CSS 選擇器**：使用專用 class 避免衝突
* **複選欄位處理**：使用 `is_array()` 檢查，`implode()` 合併
* **顯示格式**：餐廳類型用「 / 」，酒器設備用「、」

---

## 🔧 技術架構

### ACF 欄位設定
* **餐廳類型**：Checkbox 複選，最多三種
* **酒器設備**：Checkbox 複選（規劃中）
* **開瓶費**：單選，但需要處理子層級資訊
* **開酒服務**：支援「其他」選項和說明

### PHP 檔案修改
* **archive-restaurant.php**：支援複選顯示
* **single_restaurant.php**：支援複選顯示
* **安全性處理**：使用 `esc_html()` 確保輸出安全

### Apps Script 優化
* **開瓶費邏輯**：清理選項名稱，移除括號說明
* **電話號碼處理**：修正前導 0 消失問題
* **資料轉換**：統一格式處理
* **錯誤處理**：建立檢查報告機制

### Logo 設計規範
* **主概念**：高腳杯與地圖融合設計
* **色彩**：深酒紅色主調，符合專案色彩規範
* **風格**：扁平化設計，適合 logo 需求
* **應用**：網站 header、App 圖示、宣傳材料

---

## 📊 資料庫欄位（12個主要欄位）

1. **餐廳名稱**：文字欄位
2. **餐廳類型**：Checkbox 複選（台式、法式、義式、日式、美式、小酒館、咖啡廳、私廚、異國料理、燒烤、火鍋、牛排、Lounge Bar、Buffet）
3. **行政區**：下拉選單
4. **地址**：文字欄位
5. **是否收開瓶費**：單選（不收費/酌收/其他）
6. **開瓶費說明**：條件式文字欄位
7. **提供酒器設備**：Checkbox 複選（酒杯、開瓶器、冰桶、醒酒器、無提供）
8. **是否提供開酒服務**：單選（是/否/其他）+ 條件式說明
9. **餐廳聯絡電話**：文字欄位（自動格式化）
10. **官方網站/社群連結**：URL 欄位
11. **備註說明**：文字區域
12. **餐廳照片**：圖片上傳

---

## 🔄 完整流程

### 餐廳申請上架流程
1. **挑選與接觸潛力餐廳**：根據爬蟲資料或社群推薦找潛在支援 BYOB 的餐廳
2. **餐廳填寫申請表單**：表單內容包含所有主要資料庫欄位
3. **人工審核與補資料**：每週由管理者檢視表單資料
4. **轉為 WordPress 餐廳文章**：將轉換後資料手動匯入 WordPress 後台
5. **同步顯示於 App**：WordPress 餐廳資料自動開放於 REST API
6. **通知餐廳與感謝曝光**：發信或私訊通知餐廳「已成功上架」

### 資料流程
* **Google 表單** → **Google Sheets** → **Apps Script 轉換** → **WordPress 後台** → **前端顯示**

---

本日進度完成 PHP 檔案修正、Apps Script 優化、Logo 設計選擇。整體技術架構趨於完善，為後續功能開發奠定良好基礎。 