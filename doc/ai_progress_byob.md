# 📈 BYOB App 專案進度紀錄：2025-07-04

## ✅ 今日完成項目總結

### 🧪 Google 表單資料轉換模組（App Script v3）開發完成

* 成功建立從表單回應試算表 → 主資料庫格式（12 欄）的轉換流程
* 對應並驗證所有欄位，包括：行政區、地址、開瓶費邏輯、酒器設備、備註、提供人資訊
* 特別處理：

  * ✅ 「酌收」選項對應金額轉為 `$300` 顯示格式
  * ✅ 電話號碼自動補 `0` 並轉為純文字格式以保留首位
  * ✅ 備註欄不再混入其他欄位資料，只保留原備註內容

---

### ⚙️ App Script 技術優化與修正細節

* 改用 `setValues` 批次寫入資料避免逐列 `appendRow` 出錯
* 使用單引號 `'` 包覆電話數字避免 0 被省略
* 動態偵測行數並設定第 8 欄（電話）格式為 `@` 純文字格式

---

### 🧾 主資料庫欄位與表單欄位對照最終定稿

| 主資料庫欄位      | 來源欄位（表單欄）            |
| ----------- | -------------------- |
| 餐廳名稱        | 第 3 欄 row\[2]        |
| 餐廳類型        | 第 4 欄 row\[3]        |
| 行政區         | 第 5 欄 row\[4]        |
| 地址          | 第 6 欄 row\[5]        |
| 是否收開瓶費      | 經由 row\[6] + row\[7] |
| 提供酒器設備      | row\[8] + row\[9]    |
| 是否提供開酒服務？   | row\[10]             |
| 餐廳聯絡電話      | row\[11]（已處理為文字）     |
| 官方網站 / 社群連結 | row\[12] + row\[13]  |
| 備註說明        | row\[14]（僅此欄）        |
| 最後更新日期      | 系統產生                 |
| 資料來源 / 提供人  | row\[15] + row\[16]  |

---

### 📌 使用限制與後續注意事項

* 若未來更換 Google 表單連結或回應試算表：

  * ✅ **必須重新設定 App Script 並重新授權一次**（重要）
  * 現有欄位順序與名稱需同步更新程式對應位置
  * 建議製作一份初始化範本或授權流程簡易指引文件

---

✅ 所有程式邏輯、欄位轉換、欄位格式處理，皆已測試無誤。
⏭️ 明日將進一步測試特殊情境資料穩定性與替代方案。
