## BYOB 進度紀錄｜2025-08-01

### ✅ 今日重點進度

1. **PHP 檔案 emoji 亂碼問題修正**

   * 成功修正 `archive-restaurant.php` 和 `single_restaurant.php` 中的 emoji 顯示問題
   * 將所有 emoji 圖示替換為 HTML 實體編碼：
     - 地址圖示：`&#128205;` 📍
     - 電話圖示：`&#128222;` 📞
     - 開瓶費圖示：`&#127863;` 🥂
     - 開瓶費說明圖示：`&#129380;` 🪙
     - 備註圖示：`&#128221;` 📝
   * 確保在不同環境下都能正確顯示圖示

2. **開酒服務欄位邏輯修改**

   * 修改 `archive-restaurant.php` 和 `single_restaurant.php` 支援開酒服務的「其他」選項
   * 新增條件式文字欄位 `open_bottle_service_other_note` 處理邏輯
   * 顯示格式：
     - 選擇「是」：顯示「是」
     - 選擇「否」：顯示「否」
     - 選擇「其他」：顯示「其他：說明文字」
   * 使用 `esc_html()` 確保安全性

3. **開瓶費說明欄位邏輯修改**

   * 修改兩個 PHP 檔案支援開瓶費說明的條件式顯示
   * 新增 `corkage_fee_other` 欄位處理邏輯
   * 顯示邏輯：
     - 選擇「酌收」且有金額：顯示金額
     - 選擇「其他」且有說明：顯示說明文字
     - 其他情況：顯示原始選項值
   * 保持原有的圖示 `&#129380;` 不變

4. **Apps Script 電話號碼處理邏輯修正**

   * 修正數字類型電話號碼前導 0 消失的問題
   * 新增處理邏輯：
     - 8位數：補回 `02` 前綴（市話格式）
     - 9位數：補回 `0` 前綴（可能是被截斷的手機號碼）
     - 10位數：補回 `0` 前綴（完整手機號碼）
   * 確保所有電話號碼格式正確保留前導 0

5. **Logo 設計概念生成與選擇**

   * 生成三個 logo 設計概念：
     - 概念一：「高腳杯與地圖」融合設計
     - 概念二：「酒杯與指南針」組合
     - 概念三：「酒瓶標籤式地圖」
   * 修正概念一：將酒瓶改為高腳杯，更符合餐廳氛圍
   * 提供 Midjourney prompt 並調整為適合 logo 的平面設計風格
   * 生成多張 logo 設計圖，選擇第二張（深酒紅色高腳杯 + 白色地圖網格）作為最終方案

6. **技術問題解決**

   * 修正 PHP 檔案中的 JavaScript 程式碼錯誤
   * 統一複選欄位處理邏輯
   * 確保資料格式一致性
   * 建立安全性處理機制

---

### 📥 已更新與規劃項目：

* **PHP 檔案修改**：兩個檔案都支援複選顯示和條件式欄位
* **Apps Script 優化**：電話號碼處理邏輯修正完成
* **Logo 設計**：選定最終設計方案，準備明日進行圖片處理
* **資料流程規劃**：Google 表單匯入 WordPress 方案討論完成
* **技術架構**：整體技術架構趨於完善

---

### 🗓 明日預定任務（同步於 Next Task Prompt Byob）

1. **Logo 設計完成**
   - 圖片處理（upscale + 去背）
   - 格式轉換（PNG、SVG、多尺寸版本）
   - 應用測試（網站 header、App 圖示）

2. **網站頁面最後微調**
   - 確認圖示顯示正常
   - 檢查電話號碼和複選欄位邏輯
   - 測試響應式設計

3. **Google 表單自動導入 WordPress 流程**
   - 選擇並實作最佳方案
   - 建立完整測試流程
   - 建立故障排除指南

---

### 🔧 技術重點記錄：

**複選欄位處理模式：**
```php
// 檢查是否為陣列（複選）
if (is_array($field_data)) {
  $output = implode('分隔符號', $field_data);
} else {
  $output = $field_data;
}
echo esc_html($output);
```

**條件式欄位處理模式：**
```php
$field_value = get_field('field_name');
$field_other = get_field('field_name_other');

if ($field_value === 'other' && $field_other) {
  $output = '其他：' . $field_other;
} else {
  $output = $field_value;
}
```

**顯示格式規範：**
- 餐廳類型：使用「 / 」分隔
- 酒器設備：使用「、」分隔
- 開瓶費：單選，但需要處理子層級資訊
- 開酒服務：支援「其他」選項和說明

**Apps Script 電話號碼修正重點：**
- 針對數字類型電話號碼，使用 `padStart()` 確保保留前導 0
- 根據號碼長度判斷是市話還是手機號碼
- 處理可能被截斷的手機號碼（9位數補回前導0）

**Logo 設計選擇理由：**
- 第二張設計在視覺清晰度、定位邏輯、色彩搭配上都達到最佳平衡
- 深酒紅色主調完全符合專案色彩規範
- 扁平化設計風格最適合 logo 需求
- 概念傳達最直接：高腳杯代表 BYOB，地圖網格代表位置搜尋

---

**今日進度重點：完成 PHP 檔案修正、Apps Script 優化、Logo 設計選擇。整體技術架構趨於完善，為明日工作奠定良好基礎。**